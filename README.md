## 使用

需要依赖魔改版 Jelly

```shell
git clone https://github.com/werifu/jelly
cd jelly
git checkout feat-std-lib
npm i
npm run build
node lib/main.js
```

当然安装完依赖后也可以用 ts-node 直接运行，也方便 debug
```shell
ts-node /path/to/jelly/src/main.ts --callgraph-json <out>.json <file_or_package_to_be_analyzed>
```

之后是本仓库，基于用 Jelly 生成的 callgraph json 文件工作

```shell
git clone https://github.com/werifu/node-malware-detection.git
cd node-malware-detection

pip install -r requirements.txt
```

运行分割子图：
```shell
python3 main.py --base-dir <file_or_package_to_be_analyzed_dir> --callgraph-json <input>.json > result.txt
```
其中 --base-dir 参数是用来确定项目位置的，因为 jelly 生成的 json 文件中都是相对路径，在别的项目里利用需要一个基准。

--callgraph-json 是 Jelly 解析出来的 json，在此作为输入


提供了个下载npm包的脚本在 data/fetch.py 中，运行
```
python3 data/fetch.py --package-name <pkg_name> --version <ver>
```
即可下载并解压包到 data 目录下，fetch.py 里提供了别的函数不过我没公开 CLI API，自行阅读代码吧（

如果需要用到 libraries_io 的 API_KEY，运行 `cp .env.example .env` 并补充
